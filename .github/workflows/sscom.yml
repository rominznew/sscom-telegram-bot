name: SS.com Notifier

on:
  workflow_dispatch:       # –ó–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É—é
  schedule:
    - cron: "*/10 * * * *" # –ó–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç (UTC)

jobs:
  run-bot:
    runs-on: ubuntu-latest
    steps:
      - name: –°–∫–∞—á–∞—Ç—å –∫–æ–¥ –∏–∑ GitHub
        uses: actions/checkout@v3

      - name: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
        run: |
          pip install -r requirements.txt

      - name: –õ–æ–≥ –≤—Ä–µ–º–µ–Ω–∏
        run: echo "‚è∞ –ó–∞–ø—É—Å–∫ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é: $(date)"

      - name: –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
        run: python sscom_bot.py
        env:
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          CHAT_ID: ${{ secrets.CHAT_ID }}

      - name: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª seen_ads.json
        run: |
          if [ -f seen_ads.json ]; then
            echo "üìÇ seen_ads.json —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –°–æ–¥–µ—Ä–∂–∏–º–æ–µ:"
            cat seen_ads.json
          else
            echo "‚ö†Ô∏è seen_ads.json –Ω–µ –Ω–∞–π–¥–µ–Ω!"
          fi
